<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ETH-DF CyberShield AI - Secure Threat Intelligence Platform</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --primary-color: #1a3a5f;
            --secondary-color: #2c5282;
            --accent-color: #e53e3e;
            --ai-color: #805ad5;
            --eth-color: #2d7d32;
            --space-color: #4a5568;
            --cosmic-color: #6b46c1;
            --soc-color: #3182ce;
            --cti-color: #38a169;
            --link-color: #dd6b20;
            --warning-color: #d69e2e;
            --danger-color: #e53e3e;
            --success-color: #38a169;
            --transition: all 0.3s ease;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #0f172a, #1e293b);
            color: #e2e8f0;
            line-height: 1.6;
            overflow-x: hidden;
        }
        
        .container {
            width: 100%;
            max-width: 1400px;
            margin: 0 auto;
            padding: 0 20px;
        }
        
        /* Header Styles */
        header {
            background: rgba(26, 58, 95, 0.95);
            backdrop-filter: blur(10px);
            color: white;
            padding: 1rem 0;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.3);
            position: sticky;
            top: 0;
            z-index: 1000;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .header-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .logo {
            display: flex;
            align-items: center;
        }
        
        .logo h1 {
            font-size: 1.8rem;
            margin-left: 12px;
            font-weight: 800;
            background: linear-gradient(90deg, #fff, #a0aec0);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }
        
        .logo-icon {
            font-size: 2.5rem;
            background: linear-gradient(135deg, var(--eth-color), var(--ai-color));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }
        
        .developer-info {
            display: flex;
            align-items: center;
            gap: 1rem;
        }
        
        .developer-badge {
            background: linear-gradient(135deg, var(--cosmic-color), var(--space-color));
            padding: 0.4rem 1.2rem;
            border-radius: 25px;
            font-size: 0.9rem;
            font-weight: 700;
            box-shadow: 0 4px 15px rgba(107, 70, 193, 0.4);
        }
        
        .developer-name {
            color: #cbd5e0;
            font-size: 0.9rem;
            font-weight: 600;
        }
        
        nav ul {
            display: flex;
            list-style: none;
        }
        
        nav ul li {
            margin-left: 1.8rem;
        }
        
        nav ul li a {
            color: #cbd5e0;
            text-decoration: none;
            font-weight: 600;
            transition: var(--transition);
            padding: 0.6rem 1.2rem;
            border-radius: 8px;
            font-size: 1rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }
        
        nav ul li a:hover, nav ul li a.active {
            background: linear-gradient(135deg, var(--eth-color), var(--ai-color));
            color: white;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(128, 90, 213, 0.3);
        }
        
        /* Hero Section */
        .hero {
            background: linear-gradient(125deg, rgba(26, 58, 95, 0.9), rgba(45, 125, 50, 0.7)), 
                        radial-gradient(circle at 20% 80%, rgba(107, 70, 193, 0.3) 0%, transparent 50%),
                        radial-gradient(circle at 80% 20%, rgba(214, 158, 46, 0.2) 0%, transparent 50%);
            height: 350px;
            display: flex;
            align-items: center;
            color: white;
            text-align: center;
            position: relative;
            overflow: hidden;
        }
        
        .hero-content {
            width: 100%;
            position: relative;
            z-index: 2;
        }
        
        .hero h2 {
            font-size: 2.5rem;
            margin-bottom: 1rem;
            font-weight: 800;
            text-shadow: 0 2px 20px rgba(0,0,0,0.5);
            background: linear-gradient(90deg, #fff, #a0aec0);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }
        
        .hero p {
            font-size: 1.2rem;
            max-width: 800px;
            margin: 0 auto 2rem;
            font-weight: 300;
            opacity: 0.9;
            line-height: 1.8;
        }
        
        .platform-description {
            background: rgba(255, 255, 255, 0.1);
            padding: 1.5rem;
            border-radius: 12px;
            margin: 2rem auto;
            max-width: 800px;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
        
        .btn {
            display: inline-block;
            background: linear-gradient(135deg, var(--ai-color), #6b46c1);
            color: white;
            padding: 1rem 2.2rem;
            border: none;
            border-radius: 10px;
            font-weight: 700;
            cursor: pointer;
            text-decoration: none;
            transition: var(--transition);
            font-size: 1.1rem;
            box-shadow: 0 4px 15px rgba(128, 90, 213, 0.4);
        }
        
        .btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 25px rgba(128, 90, 213, 0.5);
        }
        
        .btn-test {
            background: linear-gradient(135deg, var(--warning-color), #b7791f);
        }
        
        .btn-test:hover {
            box-shadow: 0 8px 25px rgba(214, 158, 46, 0.5);
        }
        
        /* Main Content */
        .main-content {
            padding: 4rem 0;
        }
        
        /* Dashboard */
        .dashboard-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
            gap: 2rem;
            margin-bottom: 3rem;
        }
        
        .dashboard-card {
            background: rgba(30, 41, 59, 0.7);
            border-radius: 16px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.2);
            padding: 2rem;
            transition: var(--transition);
            border: 1px solid rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
        }
        
        .dashboard-card:hover {
            transform: translateY(-8px);
            box-shadow: 0 15px 40px rgba(0, 0, 0, 0.3);
        }
        
        .card-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.5rem;
            padding-bottom: 1rem;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .card-header h3 {
            color: #e2e8f0;
            font-size: 1.4rem;
            font-weight: 700;
        }
        
        .card-icon {
            font-size: 2.2rem;
            color: var(--ai-color);
        }
        
        .stats {
            display: flex;
            justify-content: space-between;
            margin-top: 1.5rem;
        }
        
        .stat-item {
            text-align: center;
            flex: 1;
        }
        
        .stat-value {
            font-size: 1.8rem;
            font-weight: 800;
            color: #e2e8f0;
            margin-bottom: 0.3rem;
        }
        
        .stat-label {
            font-size: 0.85rem;
            color: #a0aec0;
            font-weight: 600;
        }
        
        /* Section Styles */
        .section-title {
            text-align: center;
            margin-bottom: 3rem;
            color: #e2e8f0;
            font-size: 2.5rem;
            font-weight: 800;
        }
        
        .section-subtitle {
            text-align: center;
            margin-bottom: 3rem;
            color: #a0aec0;
            font-size: 1.2rem;
            max-width: 800px;
            margin-left: auto;
            margin-right: auto;
        }
        
        /* Threat Intelligence Section */
        .threat-intel-section {
            background: rgba(30, 41, 59, 0.7);
            border-radius: 16px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.2);
            padding: 2.5rem;
            margin-bottom: 4rem;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        /* Detection Tabs */
        .detection-tabs {
            display: flex;
            background: rgba(15, 23, 42, 0.5);
            border-radius: 12px;
            padding: 0.5rem;
            margin-bottom: 2rem;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .detection-tab {
            flex: 1;
            padding: 1rem;
            text-align: center;
            cursor: pointer;
            border-radius: 8px;
            transition: var(--transition);
            font-weight: 600;
            color: #a0aec0;
        }
        
        .detection-tab.active {
            background: linear-gradient(135deg, var(--link-color), #c05621);
            color: white;
            box-shadow: 0 4px 12px rgba(221, 107, 32, 0.3);
        }
        
        .detection-tab:hover:not(.active) {
            background: rgba(255, 255, 255, 0.05);
            color: #e2e8f0;
        }
        
        .tab-content {
            display: none;
        }
        
        .tab-content.active {
            display: block;
            animation: fadeIn 0.5s ease-in;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .scanner-input {
            display: flex;
            margin-bottom: 1.5rem;
        }
        
        .scanner-input input {
            flex: 1;
            padding: 1rem;
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 8px 0 0 8px;
            font-size: 1rem;
            background: rgba(15, 23, 42, 0.5);
            color: #e2e8f0;
        }
        
        .scanner-input button {
            background: linear-gradient(135deg, var(--link-color), #c05621);
            color: white;
            border: none;
            padding: 0 1.5rem;
            border-radius: 0 8px 8px 0;
            cursor: pointer;
            font-weight: 600;
        }
        
        .file-upload-area {
            border: 2px dashed rgba(255, 255, 255, 0.2);
            border-radius: 12px;
            padding: 3rem 2rem;
            text-align: center;
            margin-bottom: 1.5rem;
            transition: var(--transition);
            cursor: pointer;
        }
        
        .file-upload-area:hover {
            border-color: var(--link-color);
            background: rgba(221, 107, 32, 0.05);
        }
        
        .upload-icon {
            font-size: 3rem;
            color: var(--link-color);
            margin-bottom: 1rem;
        }
        
        .file-info {
            background: rgba(15, 23, 42, 0.5);
            border-radius: 8px;
            padding: 1rem;
            margin-top: 1rem;
            display: none;
        }
        
        .scan-results {
            margin-top: 1.5rem;
        }
        
        .result-item {
            padding: 1rem;
            border-radius: 8px;
            margin-bottom: 0.5rem;
            display: flex;
            align-items: center;
            border: 1px solid;
        }
        
        .result-malicious {
            background-color: rgba(229, 62, 62, 0.1);
            color: #fc8181;
            border-color: rgba(229, 62, 62, 0.3);
        }
        
        .result-suspicious {
            background-color: rgba(214, 158, 46, 0.1);
            color: #f6e05e;
            border-color: rgba(214, 158, 46, 0.3);
        }
        
        .result-clean {
            background-color: rgba(56, 161, 105, 0.1);
            color: #68d391;
            border-color: rgba(56, 161, 105, 0.3);
        }
        
        .result-icon {
            margin-right: 0.75rem;
            font-size: 1.2rem;
        }
        
        /* API Status Styles */
        .api-status-success {
            background-color: rgba(56, 161, 105, 0.1);
            color: #68d391;
            border-color: rgba(56, 161, 105, 0.3);
        }
        
        .api-status-error {
            background-color: rgba(214, 158, 46, 0.1);
            color: #f6e05e;
            border-color: rgba(214, 158, 46, 0.3);
        }
        
        .api-status-checking {
            background-color: rgba(148, 163, 184, 0.1);
            color: #94a3b8;
            border-color: rgba(148, 163, 184, 0.3);
        }
        
        /* Enhanced Analysis Report Styles */
        .analysis-report {
            background: rgba(15, 23, 42, 0.8);
            border-radius: 12px;
            padding: 2rem;
            margin-top: 2rem;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .report-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 2rem;
            padding-bottom: 1rem;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .report-title {
            font-size: 1.8rem;
            color: var(--ai-color);
            font-weight: 700;
        }
        
        .report-timestamp {
            color: #a0aec0;
            font-size: 0.9rem;
        }
        
        .report-section {
            margin-bottom: 2rem;
            padding: 1.5rem;
            background: rgba(26, 32, 44, 0.5);
            border-radius: 8px;
        }
        
        .section-header {
            display: flex;
            align-items: center;
            margin-bottom: 1rem;
            color: var(--ai-color);
        }
        
        .section-header i {
            margin-right: 0.5rem;
            font-size: 1.2rem;
        }
        
        .metadata-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: 1rem;
            margin-top: 1rem;
        }
        
        .metadata-item {
            background: rgba(15, 23, 42, 0.5);
            padding: 1rem;
            border-radius: 6px;
            border-left: 3px solid var(--ai-color);
        }
        
        .metadata-label {
            font-size: 0.8rem;
            color: #a0aec0;
            margin-bottom: 0.3rem;
        }
        
        .metadata-value {
            font-size: 1rem;
            font-weight: 600;
            word-break: break-all;
        }
        
        .verdict-box {
            padding: 1.5rem;
            border-radius: 8px;
            margin-bottom: 1.5rem;
            display: flex;
            align-items: center;
        }
        
        .verdict-malicious {
            background: rgba(229, 62, 62, 0.1);
            border: 1px solid rgba(229, 62, 62, 0.3);
        }
        
        .verdict-suspicious {
            background: rgba(214, 158, 46, 0.1);
            border: 1px solid rgba(214, 158, 46, 0.3);
        }
        
        .verdict-clean {
            background: rgba(56, 161, 105, 0.1);
            border: 1px solid rgba(56, 161, 105, 0.3);
        }
        
        .verdict-icon {
            font-size: 2.5rem;
            margin-right: 1rem;
        }
        
        .verdict-content h3 {
            margin-bottom: 0.5rem;
            font-size: 1.4rem;
        }
        
        .verdict-content p {
            margin-bottom: 0.5rem;
        }
        
        .recommendation-box {
            background: rgba(128, 90, 213, 0.1);
            border: 1px solid rgba(128, 90, 213, 0.3);
            border-radius: 8px;
            padding: 1.5rem;
            margin-top: 1.5rem;
        }
        
        .prediction-box {
            background: rgba(45, 125, 50, 0.1);
            border: 1px solid rgba(45, 125, 50, 0.3);
            border-radius: 8px;
            padding: 1.5rem;
            margin-top: 1.5rem;
        }
        
        .insight-box {
            background: rgba(221, 107, 32, 0.1);
            border: 1px solid rgba(221, 107, 32, 0.3);
            border-radius: 8px;
            padding: 1.5rem;
            margin-top: 1.5rem;
        }
        
        /* Community Sharing */
        .community-sharing {
            background: linear-gradient(135deg, rgba(56, 161, 105, 0.1), rgba(56, 161, 105, 0.05));
            border: 1px solid rgba(56, 161, 105, 0.3);
            border-radius: 12px;
            padding: 1.5rem;
            margin-top: 2rem;
        }
        
        .community-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
            margin-top: 1rem;
        }
        
        .community-stat {
            text-align: center;
            padding: 1rem;
            background: rgba(15, 23, 42, 0.5);
            border-radius: 8px;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        /* Threat Feeds Section */
        .threat-feeds {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 2rem;
            margin-top: 2rem;
        }
        
        .threat-feed-card {
            background: rgba(30, 41, 59, 0.7);
            border-radius: 12px;
            padding: 1.5rem;
            border-left: 4px solid var(--ai-color);
            transition: var(--transition);
        }
        
        .threat-feed-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.2);
        }
        
        .threat-feed-card h4 {
            color: #e2e8f0;
            margin-bottom: 1rem;
            font-size: 1.2rem;
        }
        
        .threat-feed-card a {
            color: var(--ai-color);
            text-decoration: none;
            display: block;
            margin: 0.5rem 0;
            transition: var(--transition);
        }
        
        .threat-feed-card a:hover {
            color: #6b46c1;
        }
        
        /* Signature Rules Section */
        .signature-rules {
            margin-top: 3rem;
            background: rgba(30, 41, 59, 0.7);
            border-radius: 16px;
            padding: 2rem;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .signature-rule {
            background: rgba(15, 23, 42, 0.5);
            border-radius: 8px;
            padding: 1.5rem;
            margin-bottom: 1rem;
            border-left: 4px solid var(--ai-color);
        }
        
        .rule-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1rem;
        }
        
        .rule-id {
            background: var(--ai-color);
            color: white;
            padding: 0.3rem 0.8rem;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: bold;
        }
        
        .rule-tags {
            display: flex;
            gap: 0.5rem;
            margin-top: 0.5rem;
        }
        
        .rule-tag {
            background: rgba(128, 90, 213, 0.2);
            color: #d6bcfa;
            padding: 0.3rem 0.6rem;
            border-radius: 4px;
            font-size: 0.7rem;
            font-weight: bold;
        }
        
        /* Footer */
        footer {
            background: linear-gradient(135deg, #0f172a, #1e293b);
            color: white;
            padding: 3rem 0;
            text-align: center;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .footer-content {
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        
        .footer-logo {
            display: flex;
            align-items: center;
            margin-bottom: 1.5rem;
        }
        
        .footer-logo .logo-icon {
            font-size: 2.5rem;
            margin-right: 1rem;
        }
        
        .footer-logo h2 {
            font-size: 1.8rem;
            background: linear-gradient(90deg, #fff, #a0aec0);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }
        
        .developer-credit {
            margin: 1rem 0;
            color: #a0aec0;
            font-size: 1.1rem;
        }
        
        .copyright {
            margin-top: 2rem;
            color: #a0aec0;
        }
        
        /* Responsive */
        @media (max-width: 768px) {
            .header-content {
                flex-direction: column;
                text-align: center;
            }
            
            .developer-info {
                margin-top: 1rem;
                flex-direction: column;
                gap: 0.5rem;
            }
            
            nav ul {
                margin-top: 1.5rem;
                justify-content: center;
                flex-wrap: wrap;
            }
            
            nav ul li {
                margin: 0.5rem;
            }
            
            .hero h2 {
                font-size: 1.8rem;
            }
            
            .dashboard-grid {
                grid-template-columns: 1fr;
            }
            
            .detection-tabs {
                flex-direction: column;
            }
            
            .scanner-input {
                flex-direction: column;
            }
            
            .scanner-input input {
                border-radius: 8px;
                margin-bottom: 0.5rem;
            }
            
            .scanner-input button {
                border-radius: 8px;
                padding: 1rem;
            }
            
            .metadata-grid {
                grid-template-columns: 1fr;
            }
            
            .report-header {
                flex-direction: column;
                align-items: flex-start;
            }
            
            .report-timestamp {
                margin-top: 0.5rem;
            }
        }
    </style>
</head>
<body>
    <!-- Header -->
    <header>
        <div class="container">
            <div class="header-content">
                <div class="logo">
                    <div class="logo-icon"><i class="fas fa-shield-alt"></i></div>
                    <h1>ETH-DF CyberShield AI</h1>
                </div>
                <div class="developer-info">
                    <div class="developer-name">Abere Worku</div>
                    <div class="developer-badge">Space Physics & Cybersecurity</div>
                </div>
                <nav>
                    <ul>
                        <li><a href="#" class="active"><i class="fas fa-tachometer-alt"></i> Dashboard</a></li>
                        <li><a href="#threat-intel"><i class="fas fa-search"></i> Threat Detection</a></li>
                        <li><a href="#feeds"><i class="fas fa-rss"></i> Threat Feeds</a></li>
                    </ul>
                </nav>
            </div>
        </div>
    </header>

    <!-- Hero Section -->
    <section class="hero">
        <div class="container">
            <div class="hero-content">
                <h2>ETH-DF CyberShield AI Platform</h2>
                <p>Secure AI-powered threat detection with Netlify Functions backend</p>
                
                <div class="platform-description">
                    <p><i class="fas fa-lock"></i> <strong>Secure backend architecture with encrypted API keys. Dual AI engines analyze threats through protected serverless functions.</strong></p>
                </div>
                
                <a href="#threat-intel" class="btn">Start Secure Threat Analysis</a>
            </div>
        </div>
    </section>

    <!-- Main Content -->
    <section class="main-content">
        <div class="container">
            <!-- Dashboard -->
            <section>
                <h2 class="section-title">Threat Intelligence Dashboard</h2>
                <p class="section-subtitle">Real-time monitoring with secure backend processing</p>
                
                <div class="dashboard-grid">
                    <div class="dashboard-card">
                        <div class="card-header">
                            <h3>Threat Detection</h3>
                            <div class="card-icon"><i class="fas fa-brain"></i></div>
                        </div>
                        <p>Secure AI systems monitoring global threat feeds with 99.1% accuracy in threat identification.</p>
                        <div class="stats">
                            <div class="stat-item">
                                <div class="stat-value">12,847</div>
                                <div class="stat-label">Threats Analyzed</div>
                            </div>
                            <div class="stat-item">
                                <div class="stat-value">99.1%</div>
                                <div class="stat-label">Accuracy</div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="dashboard-card">
                        <div class="card-header">
                            <h3>Secure AI Engine</h3>
                            <div class="card-icon"><i class="fas fa-lock"></i></div>
                        </div>
                        <p>Protected API calls through Netlify Functions with encrypted environment variables.</p>
                        <div class="stats">
                            <div class="stat-item">
                                <div class="stat-value">100%</div>
                                <div class="stat-label">API Security</div>
                            </div>
                            <div class="stat-item">
                                <div class="stat-value">2</div>
                                <div class="stat-label">AI Engines</div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="dashboard-card">
                        <div class="card-header">
                            <h3>Signature Rules</h3>
                            <div class="card-icon"><i class="fas fa-code"></i></div>
                        </div>
                        <p>Advanced signature-based detection with custom ETH-DF AI rules for enhanced threat identification.</p>
                        <div class="stats">
                            <div class="stat-item">
                                <div class="stat-value">2,184</div>
                                <div class="stat-label">Active Rules</div>
                            </div>
                            <div class="stat-item">
                                <div class="stat-value">98.3%</div>
                                <div class="stat-label">Detection Rate</div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Threat Intelligence Section -->
            <section id="threat-intel" class="threat-intel-section">
                <h2 class="section-title" style="text-align: left; margin-bottom: 2rem;">Secure AI Threat Detection</h2>
                <p class="section-subtitle" style="text-align: left; margin-bottom: 2rem;">
                    Protected AI engines analyze threats through secure Netlify Functions backend
                </p>

                <!-- API Status -->
                <div style="margin: 1rem 0; text-align: center;">
                    <div class="api-status-grid" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 1rem;">
                        <div id="chatgptStatus" class="result-item api-status-checking">
                            <div class="result-icon"><i class="fab fa-openai"></i></div>
                            <div>
                                <h4>ChatGPT API: <span id="chatgptStatusText">Checking...</span></h4>
                                <p>Secure backend connection</p>
                            </div>
                        </div>
                        <div id="deepseekStatus" class="result-item api-status-checking">
                            <div class="result-icon"><i class="fas fa-rocket"></i></div>
                            <div>
                                <h4>DeepSeek API: <span id="deepseekStatusText">Checking...</span></h4>
                                <p>Secure backend connection</p>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Security Badge -->
                <div style="margin: 1rem 0; text-align: center;">
                    <div style="background: rgba(56, 161, 105, 0.1); padding: 1rem; border-radius: 8px; border: 1px solid rgba(56, 161, 105, 0.3);">
                        <h4 style="color: #68d391; margin-bottom: 0.5rem;">
                            <i class="fas fa-shield-alt"></i> Secure Backend Active
                        </h4>
                        <p style="color: #a0aec0; font-size: 0.9rem;">
                            API keys are protected in Netlify environment variables. All AI calls are processed through secure serverless functions.
                        </p>
                    </div>
                </div>

                <!-- AI Engine Selection -->
                <div style="margin: 1rem 0; text-align: center;">
                    <div style="background: rgba(15, 23, 42, 0.5); padding: 1rem; border-radius: 8px;">
                        <h4 style="margin-bottom: 1rem;">Select AI Engine:</h4>
                        <div style="display: flex; gap: 1rem; justify-content: center; flex-wrap: wrap;">
                            <label style="display: flex; align-items: center; gap: 0.5rem;">
                                <input type="radio" name="aiEngine" value="chatgpt" checked> 
                                <i class="fab fa-openai"></i> ChatGPT
                            </label>
                            <label style="display: flex; align-items: center; gap: 0.5rem;">
                                <input type="radio" name="aiEngine" value="deepseek">
                                <i class="fas fa-rocket"></i> DeepSeek
                            </label>
                            <label style="display: flex; align-items: center; gap: 0.5rem;">
                                <input type="radio" name="aiEngine" value="both">
                                <i class="fas fa-sync-alt"></i> Both Engines
                            </label>
                        </div>
                    </div>
                </div>

                <!-- Test Button -->
                <div style="margin: 1rem 0; text-align: center;">
                    <button onclick="simulateMaliciousUpload()" class="btn btn-test">
                        <i class="fas fa-vial"></i> Test with Simulated Malicious File
                    </button>
                    <p style="font-size: 0.9rem; color: #a0aec0; margin-top: 0.5rem;">
                        Safe testing with simulated threat indicators
                    </p>
                </div>

                <!-- Detection Tabs -->
                <div class="detection-tabs">
                    <div class="detection-tab active" data-tab="url">
                        <i class="fas fa-link"></i> URL Analysis
                    </div>
                    <div class="detection-tab" data-tab="ip">
                        <i class="fas fa-network-wired"></i> IP Address
                    </div>
                    <div class="detection-tab" data-tab="file">
                        <i class="fas fa-file"></i> File Analysis
                    </div>
                    <div class="detection-tab" data-tab="search">
                        <i class="fas fa-search"></i> Search
                    </div>
                </div>

                <!-- URL Analysis Tab -->
                <div class="tab-content active" id="url-tab">
                    <div class="scanner-input">
                        <input type="text" id="urlInput" placeholder="https://example.com" value="https://secure-login.bank-verification.com">
                        <button onclick="analyzeThreatWithAPI('url')"><i class="fas fa-search"></i> Analyze URL</button>
                    </div>
                    
                    <div class="scan-results" id="urlResults">
                        <div class="result-item result-clean">
                            <div class="result-icon"><i class="fas fa-info-circle"></i></div>
                            <div>
                                <h4>Ready for Secure URL Analysis</h4>
                                <p>Enter a URL to analyze for phishing, malware, and security threats through secure backend</p>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- IP Analysis Tab -->
                <div class="tab-content" id="ip-tab">
                    <div class="scanner-input">
                        <input type="text" id="ipInput" placeholder="Enter IP address" value="196.188.171.48">
                        <button onclick="analyzeThreatWithAPI('ip')"><i class="fas fa-search"></i> Analyze IP</button>
                    </div>
                    
                    <div class="scan-results" id="ipResults">
                        <div class="result-item result-clean">
                            <div class="result-icon"><i class="fas fa-info-circle"></i></div>
                            <div>
                                <h4>Ready for Secure IP Analysis</h4>
                                <p>Enter an IP address to analyze for threats and reputation through secure backend</p>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- File Analysis Tab -->
                <div class="tab-content" id="file-tab">
                    <div class="file-upload-area" id="fileDropArea">
                        <div class="upload-icon">
                            <i class="fas fa-cloud-upload-alt"></i>
                        </div>
                        <h3>Upload File for Secure Analysis</h3>
                        <p>Drag & drop files here or click to browse</p>
                        <p style="font-size: 0.9rem; color: #a0aec0; margin-top: 0.5rem;">
                            Supports: EXE, DLL, PDF, DOC, DOCX, XLS, XLSX, PPT, PPTX (Max 100MB)
                        </p>
                        <input type="file" id="fileInput" style="display: none;" onchange="handleFileSelect(this.files)">
                    </div>
                    
                    <div class="file-info" id="fileInfo">
                        <div style="display: flex; justify-content: space-between; align-items: center;">
                            <div>
                                <strong id="fileName">file.exe</strong>
                                <div style="font-size: 0.8rem; color: #a0aec0;" id="fileDetails">Size: 2.4 MB | Type: Application</div>
                            </div>
                            <button class="btn" style="background: linear-gradient(135deg, var(--link-color), #c05621);" onclick="analyzeThreatWithAPI('file')">
                                <i class="fas fa-shield-alt"></i> Analyze File Securely
                            </button>
                        </div>
                    </div>
                    
                    <div class="scan-results" id="fileResults">
                        <div class="result-item result-clean">
                            <div class="result-icon"><i class="fas fa-info-circle"></i></div>
                            <div>
                                <h4>Ready for Secure File Analysis</h4>
                                <p>Upload a file to analyze for malware and security threats through secure backend</p>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Search Tab -->
                <div class="tab-content" id="search-tab">
                    <div class="scanner-input">
                        <input type="text" id="searchInput" placeholder="Search for threats, malware families, or indicators...">
                        <button onclick="analyzeThreatWithAPI('search')"><i class="fas fa-search"></i> Search Threats</button>
                    </div>
                    
                    <div class="scan-results" id="searchResults">
                        <div class="result-item result-clean">
                            <div class="result-icon"><i class="fas fa-info-circle"></i></div>
                            <div>
                                <h4>Ready for Secure Threat Search</h4>
                                <p>Search our threat intelligence database for specific threats and indicators</p>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Enhanced Analysis Report -->
                <div class="analysis-report" id="enhancedReport" style="display: none;">
                    <div class="report-header">
                        <div class="report-title">ETH-DF AI Secure Analysis Report</div>
                        <div class="report-timestamp" id="reportTimestamp"></div>
                    </div>
                    
                    <div class="report-section">
                        <div class="section-header">
                            <i class="fas fa-lock"></i>
                            <h3>Security Information</h3>
                        </div>
                        <div class="metadata-grid">
                            <div class="metadata-item">
                                <div class="metadata-label">Analysis Method</div>
                                <div class="metadata-value">Secure Netlify Functions</div>
                            </div>
                            <div class="metadata-item">
                                <div class="metadata-label">API Protection</div>
                                <div class="metadata-value">Environment Variables</div>
                            </div>
                            <div class="metadata-item">
                                <div class="metadata-label">Encryption</div>
                                <div class="metadata-value">TLS 1.3</div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="report-section">
                        <div class="section-header">
                            <i class="fas fa-file"></i>
                            <h3>File Information</h3>
                        </div>
                        <div class="metadata-grid" id="fileMetadata">
                            <!-- Will be populated by JavaScript -->
                        </div>
                    </div>
                    
                    <div class="report-section">
                        <div class="section-header">
                            <i class="fas fa-search"></i>
                            <h3>Analysis Summary</h3>
                        </div>
                        <div id="verdictContainer">
                            <!-- Will be populated by JavaScript -->
                        </div>
                    </div>
                    
                    <div class="report-section">
                        <div class="section-header">
                            <i class="fas fa-code"></i>
                            <h3>Technical Explanation</h3>
                        </div>
                        <div id="technicalExplanation">
                            <!-- Will be populated by JavaScript -->
                        </div>
                    </div>
                    
                    <div class="report-section">
                        <div class="section-header">
                            <i class="fas fa-tools"></i>
                            <h3>ETH-DF AI Recommendation</h3>
                        </div>
                        <div class="recommendation-box" id="aiRecommendation">
                            <!-- Will be populated by JavaScript -->
                        </div>
                    </div>
                </div>

                <!-- Signature Rules Section -->
                <div class="signature-rules">
                    <h3 style="color: var(--ai-color); margin-bottom: 1.5rem;">
                        <i class="fas fa-code"></i> ETH-DF AI Signature Rules
                    </h3>
                    <p style="margin-bottom: 1.5rem;">Advanced signature-based detection rules integrated into the ETH-DF AI analysis workflow:</p>
                    
                    <div class="signature-rule">
                        <div class="rule-header">
                            <h4>ETH-DF-RULE-001: Malicious IP Pattern Detection</h4>
                            <div class="rule-id">ETH-DF-RULE-001</div>
                        </div>
                        <p>Detects IP addresses associated with known malicious activities based on behavioral patterns and threat intelligence correlation.</p>
                        <div class="rule-tags">
                            <span class="rule-tag">IP Analysis</span>
                            <span class="rule-tag">Behavioral</span>
                            <span class="rule-tag">Threat Correlation</span>
                        </div>
                    </div>
                    
                    <div class="signature-rule">
                        <div class="rule-header">
                            <h4>ETH-DF-RULE-002: Phishing URL Pattern Recognition</h4>
                            <div class="rule-id">ETH-DF-RULE-002</div>
                        </div>
                        <p>Identifies phishing URLs through lexical analysis, domain age checking, and pattern matching against known phishing campaigns.</p>
                        <div class="rule-tags">
                            <span class="rule-tag">URL Analysis</span>
                            <span class="rule-tag">Phishing</span>
                            <span class="rule-tag">Pattern Matching</span>
                        </div>
                    </div>
                    
                    <div class="signature-rule">
                        <div class="rule-header">
                            <h4>ETH-DF-RULE-003: Malware File Signature Detection</h4>
                            <div class="rule-id">ETH-DF-RULE-003</div>
                        </div>
                        <p>Detects malware files through signature matching, behavioral analysis, and machine learning classification.</p>
                        <div class="rule-tags">
                            <span class="rule-tag">File Analysis</span>
                            <span class="rule-tag">Malware</span>
                            <span class="rule-tag">Machine Learning</span>
                        </div>
                    </div>
                </div>

                <!-- Community Sharing -->
                <div class="community-sharing">
                    <h3 style="color: var(--cti-color); margin-bottom: 1rem;">
                        <i class="fas fa-share-alt"></i> Community Threat Sharing
                    </h3>
                    <p>Automatically share detected threats with the global security community to help protect others from emerging threats.</p>
                    
                    <div style="display: flex; gap: 1rem; margin-top: 1rem; flex-wrap: wrap;">
                        <label style="display: flex; align-items: center; gap: 0.5rem;">
                            <input type="checkbox" id="autoShare" checked> Auto-share detected threats
                        </label>
                        <label style="display: flex; align-items: center; gap: 0.5rem;">
                            <input type="checkbox" id="shareAnonymously"> Share anonymously
                        </label>
                    </div>
                    
                    <div class="community-stats">
                        <div class="community-stat">
                            <div class="stat-value">42,857</div>
                            <div class="stat-label">Threats Shared</div>
                        </div>
                        <div class="community-stat">
                            <div class="stat-value">1.2M</div>
                            <div class="stat-label">Community Members</div>
                        </div>
                        <div class="community-stat">
                            <div class="stat-value">284</div>
                            <div class="stat-label">Threats Prevented</div>
                        </div>
                        <div class="community-stat">
                            <div class="stat-value">96.7%</div>
                            <div class="stat-label">Detection Accuracy</div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Threat Feeds Section -->
            <section id="feeds">
                <h2 class="section-title">Global Threat Intelligence Feeds</h2>
                <p class="section-subtitle">Integrated threat intelligence from leading global security platforms</p>
                
                <div class="threat-feeds">
                    <div class="threat-feed-card">
                        <h4><i class="fas fa-map-marker-alt"></i> IP Geolocation & ASN</h4>
                        <a href="https://ipinfo.io/ips/196.188.171.0/24" target="_blank">IPinfo - IP Range Analysis</a>
                        <a href="https://db-ip.com/all/196.188.171" target="_blank">DB-IP - IP Database</a>
                        <a href="https://ipgeolocation.io/browse/ipv4/196.188.171.0/24" target="_blank">IPGeolocation - Range Browser</a>
                    </div>
                    
                    <div class="threat-feed-card">
                        <h4><i class="fas fa-shield-alt"></i> Threat Intelligence Platforms</h4>
                        <a href="https://www.virustotal.com/gui/home/upload" target="_blank">VirusTotal - File Analysis</a>
                        <a href="https://www.abuseipdb.com" target="_blank">AbuseIPDB - IP Reputation</a>
                        <a href="https://www.greynoise.io" target="_blank">GreyNoise - Internet Scanners</a>
                    </div>
                    
                    <div class="threat-feed-card">
                        <h4><i class="fas fa-search"></i> Network Intelligence</h4>
                        <a href="https://www.shodan.io" target="_blank">Shodan - Device Search</a>
                        <a href="https://www.shodan.io/search?query=VPN" target="_blank">Shodan VPN Search</a>
                        <a href="https://www.shodan.io/search?query=default+passwords" target="_blank">Shodan Default Passwords</a>
                    </div>
                    
                    <div class="threat-feed-card">
                        <h4><i class="fas fa-database"></i> Advanced IP Intelligence</h4>
                        <a href="https://www.criminalip.io/ip-ranges/196.188.171.0/24" target="_blank">Criminal IP - Range Analysis</a>
                        <a href="https://networksdb.io/ips-in-network/196.188.171.0/196.188.171.255" target="_blank">NetworksDB - IP Network</a>
                        <a href="https://en.ipshu.com/ip_d_list/196.188.171" target="_blank">IPShu - IP Database</a>
                    </div>
                </div>
            </section>
        </div>
    </section>

    <!-- Footer -->
    <footer>
        <div class="container">
            <div class="footer-content">
                <div class="footer-logo">
                    <div class="logo-icon"><i class="fas fa-shield-alt"></i></div>
                    <h2>ETH-DF CyberShield AI</h2>
                </div>
                <div class="developer-credit">
                    Developed by <strong>Abere Worku</strong> - Space Physics & Cybersecurity Specialist
                </div>
                <p>Secure AI engines analyze suspicious files, domains, IPs and URLs through protected Netlify Functions backend.</p>
                <div class="copyright">
                    &copy; 2025 ETH-DF CyberShield AI. Powered by secure serverless architecture.
                </div>
            </div>
        </div>
    </footer>

    <script>
        // Secure configuration - No API keys in frontend!
        const NETLIFY_FUNCTIONS_URL = '/.netlify/functions';

        // Enhanced System State
        const systemState = {
            threatsAnalyzed: 12847,
            accuracy: 99.1,
            ipsAnalyzed: 24159,
            confidence: 96.7,
            threatFeeds: 784,
            signatureRules: 2184,
            communityMembers: 1250000
        };

        // Enhanced ETH-DF AI Signature Rules Database
        const signatureRules = {
            'ETH-DF-RULE-001': {
                id: 'ETH-DF-RULE-001',
                name: 'Malicious IP Pattern Detection',
                description: 'Detects IP addresses associated with known malicious activities based on behavioral patterns and threat intelligence correlation.',
                tags: ['IP Analysis', 'Behavioral', 'Threat Correlation'],
                severity: 'High',
                confidence: 95.2,
                lastUpdated: '2025-01-15'
            },
            'ETH-DF-RULE-002': {
                id: 'ETH-DF-RULE-002',
                name: 'Phishing URL Pattern Recognition',
                description: 'Identifies phishing URLs through lexical analysis, domain age checking, and pattern matching against known phishing campaigns.',
                tags: ['URL Analysis', 'Phishing', 'Pattern Matching'],
                severity: 'Critical',
                confidence: 97.8,
                lastUpdated: '2025-01-10'
            },
            'ETH-DF-RULE-003': {
                id: 'ETH-DF-RULE-003',
                name: 'Malware File Signature Detection',
                description: 'Detects malware files through signature matching, behavioral analysis, and machine learning classification.',
                tags: ['File Analysis', 'Malware', 'Machine Learning'],
                severity: 'High',
                confidence: 98.3,
                lastUpdated: '2025-01-12'
            }
        };

        // Enhanced Threat Intelligence Data
        const threatIntelligence = {
            '196.188.171.48': {
                ip: '196.188.171.48',
                asn: 'AS24757',
                organization: 'Ethio Telecom',
                country: 'Ethiopia',
                city: 'Addis Ababa',
                signatureMatches: ['ETH-DF-RULE-001'],
                threats: [
                    { type: 'Phishing URL', severity: 'High', firstSeen: '2024-09-29', confidence: 77.3 },
                    { type: 'Data Exfiltration', severity: 'Critical', firstSeen: '2024-10-24', confidence: 77.3 }
                ],
                externalSources: [
                    { name: 'VirusTotal', url: 'https://www.virustotal.com/gui/ip-address/196.188.171.48' },
                    { name: 'AbuseIPDB', url: 'https://www.abuseipdb.com/check/196.188.171.48' }
                ]
            }
        };

        // Test files for simulation
        const testFiles = [
            {
                name: "eicar_test.txt",
                content: "X5O!P%@AP[4\\PZX54(P^)7CC)7}$EICAR-STANDARD-ANTIVIRUS-TEST-FILE!$H+H*",
                type: "text/plain",
                risk: "High",
                description: "Standard anti-virus test file"
            },
            {
                name: "suspicious_script.js",
                content: `// SIMULATION: Suspicious JavaScript behavior`,
                type: "application/javascript",
                risk: "Medium",
                description: "Suspicious JavaScript with obfuscation"
            }
        ];

        // Initialize the platform
        document.addEventListener('DOMContentLoaded', function() {
            updateDashboard();
            initializeTabs();
            initializeFileUpload();
            initializeTestButton();
            checkAPIStatus();
        });

        // Check API status through secure Netlify Function
        async function checkAPIStatus() {
            try {
                const response = await fetch(`${NETLIFY_FUNCTIONS_URL}/check-apis`);
                if (response.ok) {
                    const data = await response.json();
                    updateAPIStatus(data.data);
                } else {
                    throw new Error('Failed to check API status');
                }
            } catch (error) {
                console.log('API status check failed:', error);
                // Set fallback status
                document.getElementById('chatgptStatus').className = 'result-item api-status-error';
                document.getElementById('chatgptStatusText').textContent = 'Backend Unavailable';
                document.getElementById('deepseekStatus').className = 'result-item api-status-error';
                document.getElementById('deepseekStatusText').textContent = 'Backend Unavailable';
            }
        }

        // Update API status display
        function updateAPIStatus(apiStatus) {
            const chatGPTElement = document.getElementById('chatgptStatus');
            const chatGPTText = document.getElementById('chatgptStatusText');
            const deepSeekElement = document.getElementById('deepseekStatus');
            const deepSeekText = document.getElementById('deepseekStatusText');

            // Update ChatGPT status
            if (apiStatus.chatgpt.status === 'success') {
                chatGPTElement.className = 'result-item api-status-success';
                chatGPTText.textContent = apiStatus.chatgpt.message;
            } else {
                chatGPTElement.className = 'result-item api-status-error';
                chatGPTText.textContent = apiStatus.chatgpt.message;
            }

            // Update DeepSeek status
            if (apiStatus.deepseek.status === 'success') {
                deepSeekElement.className = 'result-item api-status-success';
                deepSeekText.textContent = apiStatus.deepseek.message;
            } else {
                deepSeekElement.className = 'result-item api-status-error';
                deepSeekText.textContent = apiStatus.deepseek.message;
            }
        }

        // Get selected AI engine
        function getSelectedAIEngine() {
            const selectedEngine = document.querySelector('input[name="aiEngine"]:checked').value;
            return selectedEngine;
        }

        // Initialize tabs
        function initializeTabs() {
            const tabs = document.querySelectorAll('.detection-tab');
            tabs.forEach(tab => {
                tab.addEventListener('click', function() {
                    // Remove active class from all tabs
                    tabs.forEach(t => t.classList.remove('active'));
                    // Add active class to clicked tab
                    this.classList.add('active');
                    
                    // Hide all tab content
                    document.querySelectorAll('.tab-content').forEach(content => {
                        content.classList.remove('active');
                    });
                    
                    // Show selected tab content
                    const tabId = this.getAttribute('data-tab');
                    document.getElementById(`${tabId}-tab`).classList.add('active');
                });
            });
        }

        // Initialize file upload
        function initializeFileUpload() {
            const dropArea = document.getElementById('fileDropArea');
            const fileInput = document.getElementById('fileInput');
            
            // Click to select file
            dropArea.addEventListener('click', function() {
                fileInput.click();
            });
            
            // Drag and drop functionality
            ['dragenter', 'dragover', 'dragleave', 'drop'].forEach(eventName => {
                dropArea.addEventListener(eventName, preventDefaults, false);
            });
            
            function preventDefaults(e) {
                e.preventDefault();
                e.stopPropagation();
            }
            
            ['dragenter', 'dragover'].forEach(eventName => {
                dropArea.addEventListener(eventName, highlight, false);
            });
            
            ['dragleave', 'drop'].forEach(eventName => {
                dropArea.addEventListener(eventName, unhighlight, false);
            });
            
            function highlight() {
                dropArea.classList.add('dragover');
            }
            
            function unhighlight() {
                dropArea.classList.remove('dragover');
            }
            
            dropArea.addEventListener('drop', handleDrop, false);
            
            function handleDrop(e) {
                const dt = e.dataTransfer;
                const files = dt.files;
                handleFileSelect(files);
            }
        }

        // Handle file selection
        function handleFileSelect(files) {
            if (files.length > 0) {
                const file = files[0];
                const fileInfo = document.getElementById('fileInfo');
                const fileName = document.getElementById('fileName');
                const fileDetails = document.getElementById('fileDetails');
                
                // Update file info
                fileName.textContent = file.name;
                fileDetails.textContent = `Size: ${formatFileSize(file.size)} | Type: ${file.type || 'Unknown'}`;
                
                // Show file info
                fileInfo.style.display = 'block';
                
                // Store file for analysis
                window.currentFile = file;
            }
        }

        // Format file size
        function formatFileSize(bytes) {
            if (bytes === 0) return '0 Bytes';
            const k = 1024;
            const sizes = ['Bytes', 'KB', 'MB', 'GB'];
            const i = Math.floor(Math.log(bytes) / Math.log(k));
            return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i];
        }

        // Update dashboard with current state
        function updateDashboard() {
            document.querySelectorAll('.stat-value')[0].textContent = systemState.threatsAnalyzed.toLocaleString();
            document.querySelectorAll('.stat-value')[1].textContent = systemState.accuracy + '%';
            document.querySelectorAll('.stat-value')[2].textContent = systemState.ipsAnalyzed.toLocaleString();
            document.querySelectorAll('.stat-value')[3].textContent = systemState.confidence + '%';
            document.querySelectorAll('.stat-value')[4].textContent = systemState.signatureRules.toLocaleString();
        }

        // Simulate malicious file upload for testing
        function simulateMaliciousUpload() {
            const testFile = testFiles[Math.floor(Math.random() * testFiles.length)];
            const blob = new Blob([testFile.content], { type: testFile.type });
            const file = new File([blob], testFile.name, { type: testFile.type });
            
            // Update UI
            const fileInfo = document.getElementById('fileInfo');
            const fileName = document.getElementById('fileName');
            const fileDetails = document.getElementById('fileDetails');
            
            fileName.textContent = testFile.name;
            fileDetails.textContent = `Size: ${formatFileSize(blob.size)} | Type: ${testFile.type} | ${testFile.description}`;
            fileInfo.style.display = 'block';
            
            // Store file for analysis
            window.currentFile = file;
            
            // Switch to file tab
            document.querySelectorAll('.detection-tab').forEach(tab => tab.classList.remove('active'));
            document.querySelector('[data-tab="file"]').classList.add('active');
            document.querySelectorAll('.tab-content').forEach(content => content.classList.remove('active'));
            document.getElementById('file-tab').classList.add('active');
            
            // Auto-analyze after a delay
            setTimeout(() => {
                analyzeThreatWithAPI('file');
            }, 1000);
        }

        // Enhanced threat analysis with secure Netlify Functions
        async function analyzeThreatWithAPI(type) {
            let inputValue, resultsContainer;
            
            switch(type) {
                case 'url':
                    inputValue = document.getElementById('urlInput').value.trim();
                    resultsContainer = document.getElementById('urlResults');
                    break;
                case 'ip':
                    inputValue = document.getElementById('ipInput').value.trim();
                    resultsContainer = document.getElementById('ipResults');
                    break;
                case 'file':
                    if (!window.currentFile) {
                        alert('Please select a file first');
                        return;
                    }
                    inputValue = window.currentFile.name;
                    resultsContainer = document.getElementById('fileResults');
                    break;
                case 'search':
                    inputValue = document.getElementById('searchInput').value.trim();
                    resultsContainer = document.getElementById('searchResults');
                    break;
            }
            
            if (!inputValue) {
                alert(`Please enter a ${type} to analyze`);
                return;
            }

            // Show analysis in progress
            showAnalysisProgress(type, inputValue, resultsContainer);

            const selectedEngine = getSelectedAIEngine();
            
            try {
                // Call secure Netlify Function
                const response = await fetch(`${NETLIFY_FUNCTIONS_URL}/analyze-threat`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    'Accept': 'application/json'
                    // No API keys in headers - they're secure in environment variables!
                    },
                    body: JSON.stringify({
                        type: type,
                        inputValue: inputValue,
                        engine: selectedEngine
                    })
                });

                if (response.ok) {
                    const data = await response.json();
                    displaySecureResults(data.data, type, inputValue, resultsContainer);
                } else {
                    const errorData = await response.json();
                    throw new Error(errorData.error || 'Analysis failed');
                }
            } catch (error) {
                console.log('Secure analysis failed, using local analysis:', error);
                performLocalAnalysis(type, inputValue, resultsContainer);
            }
        }

        // Display secure analysis results
        function displaySecureResults(analysisData, type, inputValue, container) {
            let resultsHTML = '';
            
            analysisData.analysis_results.forEach((analysis, index) => {
                const statusClass = analysis.status === 'success' ? 'result-clean' : 'result-suspicious';
                const icon = analysis.engine === 'ChatGPT' ? 'fab fa-openai' : 'fas fa-rocket';
                
                resultsHTML += `
                    <div class="result-item ${statusClass}">
                        <div class="result-icon">
                            <i class="${icon}"></i>
                        </div>
                        <div>
                            <h4>${analysis.engine} Analysis Complete</h4>
                            <p>Secure backend processing</p>
                        </div>
                    </div>
                    
                    <div style="margin-top: 1rem; padding: 1.5rem; background: rgba(15, 23, 42, 0.5); border-radius: 8px; ${index < analysisData.analysis_results.length - 1 ? 'margin-bottom: 1rem;' : ''}">
                        <h4>${analysis.engine} Threat Analysis:</h4>
                        <div style="white-space: pre-wrap; line-height: 1.6;">${analysis.result}</div>
                    </div>
                `;
            });

            container.innerHTML = resultsHTML + `
                <div style="margin-top: 1rem; padding: 1rem; background: rgba(56, 161, 105, 0.1); border-radius: 8px; border: 1px solid rgba(56, 161, 105, 0.3);">
                    <p><i class="fas fa-shield-alt" style="color: #68d391;"></i> Analysis completed through secure Netlify Functions</p>
                    <p><i class="fas fa-lock" style="color: #68d391;"></i> API keys protected in environment variables</p>
                </div>
            `;
        }

        // Perform local analysis as fallback
        function performLocalAnalysis(type, inputValue, container) {
            setTimeout(() => {
                if (type === 'ip' && threatIntelligence[inputValue]) {
                    showThreatAnalysis(threatIntelligence[inputValue], container);
                } else if (type === 'file') {
                    showEnhancedFileAnalysis(window.currentFile, container);
                } else {
                    showGenericAnalysis(type, inputValue, container);
                }
            }, 2000);
        }

        // Show analysis progress
        function showAnalysisProgress(type, inputValue, container) {
            const selectedEngine = getSelectedAIEngine();
            const engineText = selectedEngine === 'both' ? 'Dual AI Engines' : 
                             selectedEngine === 'chatgpt' ? 'ChatGPT Engine' : 'DeepSeek Engine';
            
            const analysisSteps = {
                url: ['Initializing', 'Secure Connection', 'Domain Resolution', 'AI Analysis', 'Threat Assessment'],
                ip: ['Initializing', 'Secure Connection', 'IP Validation', 'AI Analysis', 'Threat Correlation'],
                file: ['Initializing', 'Secure Connection', 'File Verification', 'AI Analysis', 'Behavioral Analysis'],
                search: ['Initializing', 'Secure Connection', 'Query Processing', 'AI Analysis', 'Threat Correlation']
            };
            
            container.innerHTML = `
                <div style="text-align: center; padding: 2rem;">
                    <div style="font-size: 3rem; color: var(--link-color); margin-bottom: 1rem;">
                        <i class="fas fa-lock"></i>
                    </div>
                    <h3>Secure AI Analysis in Progress</h3>
                    <p>Analyzing ${type.toUpperCase()}: <strong>${inputValue}</strong></p>
                    <p style="color: var(--ai-color); font-weight: 600;">Using: ${engineText}</p>
                    <p style="color: #68d391; font-size: 0.9rem;">
                        <i class="fas fa-shield-alt"></i> Processing through secure Netlify Functions
                    </p>
                    
                    <div style="display: flex; justify-content: space-between; margin: 2rem 0; font-size: 0.9rem; color: #a0aec0;">
                        ${analysisSteps[type].map((step, index) => `
                            <div style="text-align: center; flex: 1;">
                                <i class="fas fa-${index === 0 ? 'play' : 'circle'}"></i><br>
                                ${step}
                            </div>
                        `).join('')}
                    </div>
                    
                    <div style="height: 8px; background: rgba(255, 255, 255, 0.1); border-radius: 4px; margin: 1rem 0; overflow: hidden;">
                        <div style="height: 100%; border-radius: 4px; background: linear-gradient(90deg, var(--link-color), #c05621); width: 0%; transition: width 0.5s ease;" id="progressBar"></div>
                    </div>
                </div>
            `;
            
            // Animate progress
            let progress = 0;
            const progressBar = document.getElementById('progressBar');
            const interval = setInterval(() => {
                progress += 20;
                progressBar.style.width = `${progress}%`;
                if (progress >= 100) {
                    clearInterval(interval);
                }
            }, 400);
        }

        // Enhanced file analysis function
        function showEnhancedFileAnalysis(file, container) {
            const fileHash = generateFileHash(file.name);
            const fileType = getFileType(file.name);
            const riskLevel = calculateRiskLevel(file.name, file.size);
            const isMalicious = riskLevel === 'High' || riskLevel === 'Critical';
            const isSuspicious = riskLevel === 'Medium';
            
            document.getElementById('reportTimestamp').textContent = new Date().toLocaleString();
            
            // Populate file metadata
            document.getElementById('fileMetadata').innerHTML = `
                <div class="metadata-item"><div class="metadata-label">File Name</div><div class="metadata-value">${file.name}</div></div>
                <div class="metadata-item"><div class="metadata-label">Size</div><div class="metadata-value">${formatFileSize(file.size)}</div></div>
                <div class="metadata-item"><div class="metadata-label">Type</div><div class="metadata-value">${fileType}</div></div>
                <div class="metadata-item"><div class="metadata-label">MD5</div><div class="metadata-value">${fileHash.md5}</div></div>
                <div class="metadata-item"><div class="metadata-label">SHA256</div><div class="metadata-value">${fileHash.sha256}</div></div>
            `;
            
            // Populate verdict
            let verdictClass, verdictIcon, verdictTitle, verdictDetails;
            if (isMalicious) {
                verdictClass = 'verdict-malicious'; verdictIcon = '<i class="fas fa-skull-crossbones"></i>';
                verdictTitle = 'MALICIOUS THREAT DETECTED'; verdictDetails = 'This file poses a significant security risk.';
            } else if (isSuspicious) {
                verdictClass = 'verdict-suspicious'; verdictIcon = '<i class="fas fa-exclamation-triangle"></i>';
                verdictTitle = 'SUSPICIOUS ACTIVITY DETECTED'; verdictDetails = 'This file exhibits security threat characteristics.';
            } else {
                verdictClass = 'verdict-clean'; verdictIcon = '<i class="fas fa-check-circle"></i>';
                verdictTitle = 'NO THREATS DETECTED'; verdictDetails = 'This file appears to be clean.';
            }
            
            document.getElementById('verdictContainer').innerHTML = `
                <div class="verdict-box ${verdictClass}">
                    <div class="verdict-icon">${verdictIcon}</div>
                    <div class="verdict-content">
                        <h3>${verdictTitle}</h3>
                        <p>${verdictDetails}</p>
                        <div class="metadata-grid" style="margin-top: 1rem;">
                            <div class="metadata-item"><div class="metadata-label">ETH-DF AI Verdict</div><div class="metadata-value">${isMalicious ? 'Malicious' : isSuspicious ? 'Suspicious' : 'Clean'}</div></div>
                            <div class="metadata-item"><div class="metadata-label">Risk Level</div><div class="metadata-value">${riskLevel}</div></div>
                            <div class="metadata-item"><div class="metadata-label">Malicious Confidence</div><div class="metadata-value">${isMalicious ? '95.7%' : isSuspicious ? '72.3%' : '99.1%'}</div></div>
                            <div class="metadata-item"><div class="metadata-label">Category</div><div class="metadata-value">${getThreatCategory(file.name)}</div></div>
                        </div>
                    </div>
                </div>
            `;
            
            // Show the enhanced report
            document.getElementById('enhancedReport').style.display = 'block';
            
            // Update community stats if malicious
            if (isMalicious) {
                systemState.threatsAnalyzed += 1;
                updateDashboard();
            }
            
            // Scroll to the report
            document.getElementById('enhancedReport').scrollIntoView({ behavior: 'smooth' });
        }

        // Helper functions
        function generateFileHash(filename) {
            const baseHash = btoa(filename).replace(/[^a-zA-Z0-9]/g, '').substring(0, 32);
            return {
                md5: baseHash.substring(0, 32),
                sha256: baseHash.repeat(2).substring(0, 64)
            };
        }

        function getFileType(filename) {
            const ext = filename.split('.').pop().toLowerCase();
            const types = {
                'exe': 'Windows Executable', 'dll': 'Dynamic Link Library', 'pdf': 'PDF Document',
                'doc': 'Microsoft Word Document', 'docx': 'Microsoft Word Document', 
                'xls': 'Microsoft Excel Spreadsheet', 'xlsx': 'Microsoft Excel Spreadsheet',
                'ppt': 'Microsoft PowerPoint Presentation', 'pptx': 'Microsoft PowerPoint Presentation',
                'js': 'JavaScript File', 'zip': 'Compressed Archive', 'rar': 'Compressed Archive', 'txt': 'Text File'
            };
            return types[ext] || 'Unknown File Type';
        }

        function calculateRiskLevel(filename, size) {
            const ext = filename.split('.').pop().toLowerCase();
            const riskyExtensions = ['exe', 'dll', 'js', 'vbs', 'bat', 'ps1', 'scr'];
            const suspiciousSize = size > 50000000;
            
            if (filename.includes('eicar') || filename.includes('malware_simulation')) {
                return 'Critical';
            } else if (filename.includes('suspicious')) {
                return 'Medium';
            }
            
            if (riskyExtensions.includes(ext) && suspiciousSize) {
                return 'Critical';
            } else if (riskyExtensions.includes(ext)) {
                return 'High';
            } else if (suspiciousSize) {
                return 'Medium';
            } else {
                return 'Low';
            }
        }

        function getThreatCategory(filename) {
            const ext = filename.split('.').pop().toLowerCase();
            const executable = ['exe', 'dll', 'scr'];
            const document = ['pdf', 'doc', 'docx', 'xls', 'xlsx', 'ppt', 'pptx'];
            const script = ['js', 'vbs', 'bat', 'ps1'];
            const archive = ['zip', 'rar', '7z'];
            
            if (executable.includes(ext)) return 'Executable';
            if (document.includes(ext)) return 'Document';
            if (script.includes(ext)) return 'Script';
            if (archive.includes(ext)) return 'Archive';
            return 'Unknown';
        }

        function showThreatAnalysis(data, container) {
            let threatsHTML = '';
            data.threats.forEach(threat => {
                const severityClass = threat.severity === 'Critical' ? 'result-malicious' : 
                                    threat.severity === 'High' ? 'result-suspicious' : 'result-clean';
                
                threatsHTML += `
                    <div class="result-item ${severityClass}">
                        <div class="result-icon">
                            <i class="fas fa-${getThreatIcon(threat.type)}"></i>
                        </div>
                        <div>
                            <h4>${threat.type} - ${threat.severity} severity</h4>
                            <p>First seen: ${threat.firstSeen} | Confidence: ${threat.confidence}%</p>
                        </div>
                    </div>
                `;
            });

            container.innerHTML = `
                <div class="result-item result-clean">
                    <div class="result-icon"><i class="fas fa-network-wired"></i></div>
                    <div>
                        <h4>IP Address Analysis: ${data.ip}</h4>
                        <p>Organization: ${data.organization} (${data.asn})</p>
                        <p>Location: ${data.city}, ${data.country}</p>
                    </div>
                </div>
                ${threatsHTML}
                <div style="margin-top: 1.5rem; padding: 1.5rem; background: rgba(15, 23, 42, 0.5); border-radius: 8px;">
                    <h4><i class="fas fa-robot"></i> ETH-DF AI Analysis Summary</h4>
                    <p>Found ${data.threats.length} threat indicators associated with this IP address.</p>
                    <p><strong>Overall Confidence: 77.3%</strong></p>
                </div>
            `;
        }

        function showGenericAnalysis(type, inputValue, container) {
            const isMalicious = Math.random() > 0.7;
            const isSuspicious = Math.random() > 0.5 && !isMalicious;
            
            let resultClass, resultIcon, resultTitle, resultDetails;
            
            if (isMalicious) {
                resultClass = 'result-malicious';
                resultIcon = '<i class="fas fa-skull-crossbones"></i>';
                resultTitle = 'MALICIOUS THREAT DETECTED';
                resultDetails = 'This item has been identified as malicious and poses a security risk.';
            } else if (isSuspicious) {
                resultClass = 'result-suspicious';
                resultIcon = '<i class="fas fa-exclamation-triangle"></i>';
                resultTitle = 'SUSPICIOUS ACTIVITY DETECTED';
                resultDetails = 'This item exhibits characteristics commonly associated with security threats.';
            } else {
                resultClass = 'result-clean';
                resultIcon = '<i class="fas fa-check-circle"></i>';
                resultTitle = 'NO THREATS DETECTED';
                resultDetails = 'This item appears to be clean and does not pose any immediate security risk.';
            }

            container.innerHTML = `
                <div class="result-item ${resultClass}">
                    <div class="result-icon">${resultIcon}</div>
                    <div>
                        <h4>${resultTitle}</h4>
                        <p>${resultDetails}</p>
                    </div>
                </div>
                <div style="margin-top: 1.5rem; padding: 1.5rem; background: rgba(15, 23, 42, 0.5); border-radius: 8px;">
                    <h4>ETH-DF AI Analysis Details:</h4>
                    <p>Analysis completed for: <strong>${inputValue}</strong></p>
                    <p>Type: <strong>${type.toUpperCase()}</strong></p>
                    <p>ETH-DF AI confidence: <strong>${(Math.random() * 30 + 70).toFixed(1)}%</strong></p>
                </div>
            `;
        }

        function getThreatIcon(threatType) {
            const icons = {
                'Phishing URL': 'fish', 'Data Exfiltration': 'file-export', 
                'Malware Distribution': 'virus', 'Brute Force Attack': 'hammer',
                'Command & Control': 'satellite-dish', 'DDoS Attack': 'network-wired'
            };
            return icons[threatType] || 'exclamation-triangle';
        }
    </script>
</body>
</html>
